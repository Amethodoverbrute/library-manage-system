æˆ‘æ¥ä¸ºä½ ç”Ÿæˆæ‰€æœ‰é‡è¦æ–‡ä»¶çš„å…³é”®æ³¨é‡Šï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£æ•´ä¸ªé¡¹ç›®ç»“æ„ã€‚è®©æˆ‘å…ˆæŸ¥çœ‹å„ä¸ªæ–‡ä»¶çš„è¯¦ç»†å†…å®¹ï¼š


 
          

# ğŸ“š å›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ - å…³é”®æ³¨é‡Šæ–‡æ¡£

## ğŸ—ï¸ é¡¹ç›®æ¶æ„æ€»è§ˆ

### æŠ€æœ¯æ ˆ
- **å‰ç«¯**: Vue 3 + TypeScript + Element Plus + Vite
- **åç«¯**: Node.js + Express + MySQL
- **ä»£ç†**: Viteå¼€å‘ä»£ç†æœåŠ¡å™¨
- **æ•°æ®åº“**: MySQL (è¿æ¥æ± æ¨¡å¼)

---

## ğŸ“ åç«¯ (lms-backend)

### ğŸ”§ é…ç½®æ–‡ä»¶ (config.js)
```javascript
const configs = {
  mysql: {
    host: process.env.DB_HOST || "localhost",        // æ•°æ®åº“ä¸»æœº
    user: process.env.DB_USER || "root",             // æ•°æ®åº“ç”¨æˆ·å
    password: process.env.DB_PASSWORD || "973100",   // æ•°æ®åº“å¯†ç ï¼ˆç¯å¢ƒå˜é‡ï¼‰
    database: process.env.DB_NAME || "amob_lms",     // æ•°æ®åº“åç§°
  },
};
```
**ğŸ’¡ å…³é”®ç‚¹**:
- æ”¯æŒç¯å¢ƒå˜é‡é…ç½®ï¼Œä¾¿äºéƒ¨ç½²
- ä½¿ç”¨è¿æ¥æ± æ¨¡å¼ç®¡ç†æ•°æ®åº“è¿æ¥

---

### ğŸš€ ä¸»æœåŠ¡ (app.js)

#### 1. **CORSè·¨åŸŸé…ç½®**
```javascript
app.use(cors({
  origin: ['http://localhost:8080', 'http://127.0.0.1:8080'], // å…è®¸çš„å‰ç«¯åœ°å€
  credentials: true,  // å…è®¸å‘é€Cookieå’Œè®¤è¯ä¿¡æ¯
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'], // å…è®¸çš„HTTPæ–¹æ³•
}));
```
**ğŸ’¡ å…³é”®ç‚¹**: è§£å†³å‰åç«¯è·¨åŸŸé—®é¢˜ï¼Œæ”¯æŒå¼€å‘ç¯å¢ƒçš„8080ç«¯å£

#### 2. **æ•°æ®åº“è¿æ¥æ± **
```javascript
const pool = mysql.createPool(dbConfig); // åˆ›å»ºè¿æ¥æ± 
pool.getConnection((err) => {
  if (err) console.error("æ•°æ®åº“è¿æ¥å¤±è´¥:", err);
  else console.log("æ•°æ®åº“è¿æ¥æˆåŠŸ");
});
```
**ğŸ’¡ å…³é”®ç‚¹**: 
- ä½¿ç”¨è¿æ¥æ± æé«˜æ€§èƒ½
- å¯åŠ¨æ—¶æµ‹è¯•æ•°æ®åº“è¿æ¥

#### 3. **æœç´¢åˆ†é¡µæ¥å£** (`/get`)
```javascript
// è·å–åˆ†é¡µå‚æ•°
const page = parseInt(req.query.page) || 1;       // å½“å‰é¡µç ï¼ˆé»˜è®¤1ï¼‰
const pageSize = parseInt(req.query.pageSize) || 10; // æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤10ï¼‰
const offset = (page - 1) * pageSize;            // è®¡ç®—åç§»é‡

// SQLåˆ†é¡µæŸ¥è¯¢
let countSql = "SELECT COUNT(*) as total FROM books"; // è·å–æ€»æ•°
let dataSql = "SELECT * FROM books LIMIT ? OFFSET ?"; // è·å–åˆ†é¡µæ•°æ®
```
**ğŸ’¡ å…³é”®ç‚¹**:
- æ”¯æŒæœç´¢å…³é”®è¯ `book_name` æ¨¡ç³ŠæŸ¥è¯¢
- å…ˆæŸ¥è¯¢æ€»æ•°ï¼Œå†æŸ¥è¯¢åˆ†é¡µæ•°æ®
- è¿”å›å®Œæ•´åˆ†é¡µä¿¡æ¯ï¼ˆå½“å‰é¡µã€æ€»é¡µæ•°ã€æ˜¯å¦æœ‰ä¸Šä¸€é¡µ/ä¸‹ä¸€é¡µç­‰ï¼‰

#### 4. **CRUDæ“ä½œå®‰å…¨å®è·µ**
```javascript
// å®‰å…¨æ€§1: å‚æ•°åŒ–æŸ¥è¯¢ï¼Œé˜²SQLæ³¨å…¥
const sql = `INSERT INTO books(book_name, author, book_type, remarks) VALUES (?, ?, ?, ?)`;
connection.query(sql, [book_name, author, book_type, remarks], callback);

// å®‰å…¨æ€§2: é‡Šæ”¾æ•°æ®åº“è¿æ¥
connection.release(); // é‡è¦ï¼é˜²æ­¢è¿æ¥æ³„æ¼

// å®‰å…¨æ€§3: é”™è¯¯å¤„ç†
if (err) {
  console.error("æ“ä½œå¤±è´¥:", err);
  return res.status(500).json({ error: "æ“ä½œå¤±è´¥", details: err.message });
}
```

#### 5. **æµ‹è¯•æ¥å£**
- `/test` - å¼€å‘ç¯å¢ƒç›´è¿æµ‹è¯•
- `/api/test` - ä»£ç†ç¯å¢ƒæµ‹è¯•

---

## ğŸ“ å‰ç«¯ (lms-frontend)

### âš¡ å¯åŠ¨é…ç½® (vite.config.ts)
```javascript
export default defineConfig({
  server: {
    host: "127.0.0.1",  // å¼€å‘æœåŠ¡å™¨åœ°å€
    port: 8080,         // å¼€å‘æœåŠ¡å™¨ç«¯å£
  },
  proxy: {
    "/api": {
      target: "http://127.0.0.1:8000",  // åç«¯åœ°å€
      changeOrigin: true,                // ä¿®æ”¹è¯·æ±‚å¤´ä¸­çš„Host
      rewrite(path) {
        return path.replace(/^\/api/, ""); // /api/* â†’ /*
      },
    },
  },
});
```
**ğŸ’¡ å…³é”®ç‚¹**:
- å¼€å‘ç¯å¢ƒä»£ç†ï¼š`/api/get` â†’ `http://127.0.0.1:8000/get`
- ç”Ÿäº§ç¯å¢ƒéœ€è¦é…ç½®Nginxç­‰åå‘ä»£ç†

---

### ğŸŒ HTTPé…ç½® (src/http/index.ts)

#### 1. **ç¯å¢ƒé€‚é…**
```javascript
const isDevelopment = import.meta.env.DEV;
const baseURL = isDevelopment ? 'http://127.0.0.1:8000' : '/api';
```
**ğŸ’¡ å…³é”®ç‚¹**: 
- å¼€å‘ç¯å¢ƒç›´æ¥è®¿é—®åç«¯åœ°å€
- ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆé€šè¿‡ä»£ç†ï¼‰

#### 2. **è¯·æ±‚/å“åº”æ‹¦æˆªå™¨**
```javascript
// è¯·æ±‚æ‹¦æˆªå™¨ï¼šæ‰“å°è°ƒè¯•ä¿¡æ¯
api.interceptors.request.use((config) => {
  console.log('ğŸš€ å‘é€è¯·æ±‚:', config.method?.toUpperCase(), config.url);
  return config;
});

// å“åº”æ‹¦æˆªå™¨ï¼šå¤„ç†å“åº”å’Œé”™è¯¯
api.interceptors.response.use(
  (response) => {
    console.log('âœ… æ”¶åˆ°å“åº”:', response.status, response.config.url);
    return response;
  },
  (error) => {
    console.error('âŒ å“åº”é”™è¯¯:', error.response?.status);
    return Promise.reject(error);
  }
);
```

#### 3. **åˆ†é¡µæœç´¢æ¥å£**
```javascript
const get = (book_name: string, pagination?: PaginationParams) => {
  const params = new URLSearchParams();
  
  // æœç´¢å…³é”®è¯
  if (book_name) {
    params.append('book_name', book_name);
  }
  
  // åˆ†é¡µå‚æ•°
  if (pagination?.page) params.append('page', pagination.page.toString());
  if (pagination?.pageSize) params.append('pageSize', pagination.pageSize.toString());
  
  return api.get(`/get${params.toString() ? '?' + params.toString() : ''}`);
};
```

---

### ğŸ  ä¸»åº”ç”¨ (src/App.vue)

#### 1. **åˆ†é¡µçŠ¶æ€ç®¡ç†**
```javascript
const pagination = ref({
  currentPage: 1,      // å½“å‰é¡µç 
  pageSize: 10,        // æ¯é¡µæ•°é‡
  total: 0,            // æ€»æ•°é‡
  totalPages: 0,       // æ€»é¡µæ•°
  hasNext: false,      // æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
  hasPrev: false,      // æ˜¯å¦æœ‰ä¸Šä¸€é¡µ
  from: 0,             // å½“å‰é¡µèµ·å§‹æ¡æ•°
  to: 0                // å½“å‰é¡µç»“æŸæ¡æ•°
});
```

#### 2. **æœç´¢åŠ è½½é€»è¾‘**
```javascript
const load = async (page?: number, pageSize?: number) => {
  // ä½¿ç”¨åˆ†é¡µå‚æ•°è°ƒç”¨æ¥å£
  const paginationParams = {
    page: page || pagination.value.currentPage,
    pageSize: pageSize || pagination.value.pageSize
  };
  
  const response = await get(searchVal.value, paginationParams);
  const data = response.data;
  
  if (data.success) {
    tableData.value = data.data;              // æ›´æ–°è¡¨æ ¼æ•°æ®
    if (data.pagination) {
      pagination.value = data.pagination;     // æ›´æ–°åˆ†é¡µä¿¡æ¯
    }
  }
};
```

#### 3. **åˆ†é¡µæ§ä»¶**
```html
<el-pagination
  v-model:current-page="pagination.currentPage"
  v-model:page-size="pagination.pageSize"
  :page-sizes="[5, 10, 20, 50]"
  :total="pagination.total"
  layout="sizes, prev, pager, next, jumper, ->, total"
  @size-change="handlePageSizeChange"
  @current-change="handlePageChange"
/>
```

---

### ğŸ“ æ·»åŠ /ç¼–è¾‘ç»„ä»¶ (src/components/addBook.vue)

#### 1. **è¡¨å•éªŒè¯**
```javascript
const rules = reactive<FormRules>({
  book_name: [
    { required: true, message: "ä¹¦åä¸èƒ½ä¸ºç©º", trigger: "blur" },
    { min: 2, max: 256, message: "ä¹¦åé•¿åº¦éœ€åœ¨2-256å­—ç¬¦", trigger: "blur" },
  ],
  // ... å…¶ä»–å­—æ®µéªŒè¯è§„åˆ™
});
```

#### 2. **æ–°å¢/ç¼–è¾‘åˆ¤æ–­**
```javascript
const save = async () => {
  const valid = await ruleFormRef.value.validate();
  
  if (valid) {
    const id = Number(form.value.id);
    
    if (id > 0) {
      // ç¼–è¾‘æ“ä½œ
      const res = await edit(form.value);
      emits("success", "ä¿®æ”¹æˆåŠŸï¼");
    } else {
      // æ–°å¢æ“ä½œ
      const res = await add(form.value);
      emits("success", "æ·»åŠ æˆåŠŸï¼");
    }
  }
};
```

#### 3. **æ•°æ®ç›‘å¬**
```javascript
watch(() => props.info, (newInfo) => {
  if (newInfo) {
    // å…³é”®ï¼šç¡®ä¿idè½¬ä¸ºæ•°å­—
    const id = newInfo.id ? Number(newInfo.id) : 0;
    
    form.value = {
      id: id,
      book_name: newInfo.book_name || "",
      author: newInfo.author || "",
      book_type: newInfo.book_type || newInfo.type_name || "", // å…¼å®¹æ€§å¤„ç†
      remarks: newInfo.remarks || "",
    };
  }
}, { immediate: true });
```

---

### ğŸš€ åº”ç”¨å¯åŠ¨ (src/main.ts)
```javascript
import { createApp } from "vue";
import App from "./App.vue";
import ElementPlus from "element-plus";
import "element-plus/dist/index.css";

const app = createApp(App);
app.use(ElementPlus);    // æ³¨å†ŒElement Plus
app.mount("#app");       // æŒ‚è½½åˆ°DOM
```

---

## ğŸ”„ æ•°æ®æµå‘å›¾

```
ç”¨æˆ·æ“ä½œ â†’ å‰ç«¯ç»„ä»¶ â†’ HTTPæ¥å£ â†’ åç«¯API â†’ æ•°æ®åº“æŸ¥è¯¢ â†’ è¿”å›æ•°æ® â†’ æ›´æ–°UI
```

## ğŸ› ï¸ å…³é”®æŠ€æœ¯è¦ç‚¹

### 1. **å®‰å…¨å®è·µ**
- âœ… å‚æ•°åŒ–æŸ¥è¯¢é˜²SQLæ³¨å…¥
- âœ… CORSè·¨åŸŸé…ç½®
- âœ… è¡¨å•éªŒè¯
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶

### 2. **æ€§èƒ½ä¼˜åŒ–**
- âœ… æ•°æ®åº“è¿æ¥æ± 
- âœ… åˆ†é¡µæŸ¥è¯¢å‡å°‘æ•°æ®ä¼ è¾“
- âœ… è¯·æ±‚/å“åº”æ‹¦æˆªå™¨è°ƒè¯•
- âœ… ç¯å¢ƒé€‚é…é¿å…é‡å¤é…ç½®

### 3. **ç”¨æˆ·ä½“éªŒ**
- âœ… å“åº”å¼UIè®¾è®¡
- âœ… å®æ—¶æœç´¢
- âœ… åˆ†é¡µå¯¼èˆª
- âœ… åŠ è½½çŠ¶æ€å’Œé”™è¯¯æç¤º

### 4. **å¼€å‘ä½“éªŒ**
- âœ… ç¯å¢ƒå˜é‡é…ç½®
- âœ… çƒ­æ›´æ–°å¼€å‘
- âœ… è¯¦ç»†æ—¥å¿—è¾“å‡º
- âœ… ç±»å‹å®‰å…¨ï¼ˆTypeScriptï¼‰

---

## ğŸš€ éƒ¨ç½²æ³¨æ„äº‹é¡¹

### å¼€å‘ç¯å¢ƒ
- å‰ç«¯: `http://localhost:8080` (Viteä»£ç†)
- åç«¯: `http://127.0.0.1:8000` (ç›´è¿)

### ç”Ÿäº§ç¯å¢ƒ
- å‰ç«¯: é€šè¿‡Nginxæä¾›é™æ€æ–‡ä»¶
- ä»£ç†é…ç½®: `/api/*` â†’ åç«¯åœ°å€
- æ•°æ®åº“: ç‹¬ç«‹çš„MySQLæœåŠ¡

è¿™ä¸ªç³»ç»Ÿç°åœ¨å…·å¤‡äº†å®Œæ•´çš„å›¾ä¹¦ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬æœç´¢ã€åˆ†é¡µã€å¢åˆ æ”¹æŸ¥ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼ğŸ‰